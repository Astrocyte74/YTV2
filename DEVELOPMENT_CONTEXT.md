# üöÄ YTV2 Development Context & Session Handoff

*Generated by Claude Code session on 2025-08-31*

## üìã Current Status

**Working Setup**: NAS + ngrok (local development active)
**Decision**: Stick with NAS/ngrok approach due to YouTube cloud IP blocking issues
**Active Environment**: http://192.168.4.54:6452/ (local access)
**Next Session Location**: `/Volumes/Docker/YTV2` (direct production code access)

## üéØ Project Overview

**YTV2** - AI-powered YouTube video summarizer with Telegram bot interface
- **Telegram Bot**: Processes YouTube URLs via interactive buttons
- **Multi-AI Support**: OpenAI, Anthropic, OpenRouter integration
- **Web Dashboard**: HTML reports with audio player integration
- **Audio Processing**: Transcript extraction + TTS-optimized summaries

## üîß Current Architecture

### **Production Environment (Working)**
- **NAS**: ASUSTOR Docker container `youtube-summarizer-bot`
- **Access**: 
  - Local: `http://192.168.4.54:6452/`
  - External: ngrok tunnel (currently bandwidth limited until tomorrow)
- **Management**: `./mkpy` script with options 1-6
- **Container**: `fff8cc2da8a5` (python:3.11-slim, Up 7 hours, healthy)

### **Key Files & Locations**
- **Production Code**: `/Volumes/Docker/YTV2/`
- **Environment**: `stack.env` (contains working API keys)
- **Management Script**: `mkpy` (restart, logs, status commands)
- **Main Bot**: `telegram_bot.py`
- **Core Engine**: `youtube_summarizer.py`
- **AI Config**: `llm_config.py`

## üîë Working Configuration

### **Environment Variables (from stack.env)**
```bash
TELEGRAM_BOT_TOKEN=8277446371:AAE7nok1cOaToQno9qRqdZC_O9O0efGAzUQ
TELEGRAM_USER_ID=8350044022
OPENAI_API_KEY=sk-proj-Tv45zgqnM10P7hKSwA9Hf8ahRd-54HGF_sM2TLPQi7LkBrc7e6KA7KLPE4j4e2t5Ab3MixYUuRT3BlbkFJaJO9FrwvFjgG7BETGslWcG1A456rFJgrq2s137g9EE7Ep1zyktbJt9LZarh44ziXeKJ66IOhT4A
OPENROUTER_API_KEY=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
```

### **Docker Container Details**
- **Image**: `python:3.11-slim`
- **Port**: `6452:6452` (mapped to host)
- **Health**: Healthy status confirmed
- **Network**: Accessible at `0.0.0.0:6452`

## üìä Summary Types Available

User can select via Telegram buttons:
- `comprehensive` - Standard detailed summary  
- **`audio`** - Conversational, TTS-optimized (recommended default)
- `bullet-points` - Concise bullet format
- `key-insights` - Actionable insights focus
- `executive` - Executive-style summary  
- `adaptive` - Adapts to content complexity

## üåê Deployment Experiments

### **Render Cloud Attempt**
- **Repository**: https://github.com/Astrocyte74/YTV2
- **Status**: ‚ùå Failed due to YouTube IP blocking cloud providers
- **Learning**: Created render.yaml, Docker optimizations, GitHub integration
- **Files Created**: `render.yaml`, updated `Dockerfile`, `/health` endpoint

### **Decision Rationale**
- **Cloud Hosting Issue**: YouTube blocks most cloud provider IPs
- **Cost Analysis**: ngrok Personal ($8/month) < Render + Proxy ($17-27/month)  
- **Simplicity**: NAS setup already works perfectly
- **Reliability**: Home IP not blocked by YouTube

## üîÑ Common Operations

### **Restart Bot Container**
```bash
./mkpy
# Choose option 3: Restart YouTube Bot
```

### **View Logs**
```bash
./mkpy  
# Choose option 4: Show Portainer Logs
```

### **Check Status**
```bash
./mkpy
# Choose option 2: Check Status (NGROK + container)
```

### **Local Testing**
- **Health Check**: `http://192.168.4.54:6452/health`
- **Web Interface**: `http://192.168.4.54:6452/`
- **Test Bot**: Send YouTube URL to Telegram bot

## üö® Important Notes

### **Current Limitations**
- **NGROK Bandwidth**: Free tier exceeded until tomorrow (resets daily)
- **Cloud Hosting**: YouTube blocks cloud IPs (Render, Railway, etc.)
- **Bot Token**: Only one instance can run (Telegram API limitation)

### **Development Workflow**
1. **Edit**: Make changes in `/Volumes/Docker/YTV2/`
2. **Restart**: Use `./mkpy` option 3 to restart container
3. **Test**: Verify at `http://192.168.4.54:6452/`
4. **Deploy**: Push to GitHub when ready (for backup/sharing)

## üéØ Next Session Goals

### **Immediate Tasks**
- [ ] Access production codebase directly at `/Volumes/Docker/YTV2/`
- [ ] Continue feature development with immediate testing capability
- [ ] Optimize audio summary generation
- [ ] Enhance web dashboard functionality

### **Potential Improvements**
- [ ] Better error handling for transcript extraction failures  
- [ ] Enhanced audio processing features
- [ ] Mobile-responsive web interface improvements
- [ ] Additional AI provider integrations

## üîó Context Preservation

### **Key Decisions Made**
1. **Hosting Strategy**: NAS + ngrok over cloud (due to YouTube IP restrictions)
2. **Default Summary**: `audio` type for TTS optimization
3. **Development Approach**: Direct production code editing for faster iteration
4. **Architecture**: Keep working setup, add cloud knowledge for other projects

### **Technical Learnings**
- Render deployment process and GitHub integration
- Docker containerization best practices
- Health check endpoints (`/health` added to telegram_bot.py)
- Environment variable management for multiple platforms
- YouTube IP blocking patterns for cloud providers

## üéâ Success Metrics

**Current State**: ‚úÖ Fully functional bot with web interface
**Performance**: ‚úÖ Container healthy, 7 hours uptime  
**Integration**: ‚úÖ Telegram + AI + Web dashboard working
**Cost Efficiency**: ‚úÖ $8/month vs $17-27/month alternatives

---

**üîÑ Handoff Complete**: New session should continue development directly in `/Volumes/Docker/YTV2/` with full context of decisions, working configuration, and next steps.